# JavaScript的基础语法

> 基础不牢，地动山摇。—— 某高中数学老师

## 序言

“给我去学JavaScript语法！”

这是无名杀圈子里，熟悉代码的老手对于部分新手经常说的一句话。90%的问题可以在熟练了JavaScript语法后得到解释，而不熟悉语法的萌新通常会把本体中武将的技能代码按自己的理解随意挪用缝合，导致一些离谱至极的东西出现，甚至让人都懒得吐槽。

不客气的说，任何跳过基础语法而教你写技能的教程，都是在促使这种烦人萌新的出现，除非他们注明阅读教程需要JavaScript基础。

然而，也可以理解。网络上大多数JavaScript语法的弱保软教程，都是基于网页框架的。这就会让只对无名杀感兴趣的初学者一头雾水。他们可能需要手动建一个网页才能看到代码的实际效果。我们不需要，我们直接用上个章节我们制作的扩展进行修改。

本章节大量参考和引用了[菜鸟教程](https://www.runoob.com/js/js-syntax.html)中关于JavaScript语法的章节，如果你嫌后面太长，也可以直接看这个。

## 字面量

在计算机科学中，字面量是用于表达源代码中一个固定值的表示法（通俗称呼为“常量”，本教程里可能同时使用这两种称呼）。可能这样的定义让你感到疑惑，不要紧，我们来举例说明。

### 数字

数字字面量，可以是整数或者是小数，或者是科学计数(e)，例如：

```
2.73
114514
191e5 
```

此外，还有一些特殊的数字字面量，例如：
```JavaScript
NaN //表示一个“不是数”的数字字面量。当我们进行非法的字符转换数字时，会得到这个数。
Infinity //表示“无穷大”。
```

在第一章的教学中，我们看到过如下代码：

```JavaScript
        character:{
            'jxkz_pamu':['male','shu',5,['jxkz_shuohua','jxkz_baoyuan'],['des:列车长。']],
        },
```

这里的```5```就是一个数字字面量。

（后面我们可能要多次提到这段代码，为了避免多次贴代码的重复引用，以下称呼这段代码为**角色信息代码**。）

### 字符串

字符串（String）字面量表示一段字符。在代码中，用双引号或者单引号括起来的部分就是字符串字面量，例如：

```JavaScript
"hello"
'hello noname'
"你好"
```

没有任何字符的字符串，也是一个字符串，我们称呼为空字符串，可以表示为```""```或者```''```。

如果我们需要在字符串中包含引号，可以有两种方式。如果字符串里仅包含单引号或者只包含双引号，那么包含单引号的字符串我们用双引号囊括，包含双引号的字符串我们用单引号囊括即可：

```JavaScript
"This is a 'demo'."
'This is a "demo" too.'
```

还有一种方式是在单/双引号前添加转义符号```\```。

```JavaScript
"This is a \"demo\""
'Do you know this \'demo\'?'
```

请注意：除了需要显示的字符串内之外，我们在程序代码中使用的标点符号均为半角符号，例如：

```
,.()[];:""''^&
```

在输入这些符号时，请确保你的输入法处于英文状态。全角符号（也称“中文标点”），例如```，。；：“”‘’```等，在程序代码里是会造成语法错误的。

在**角色信息代码**中，我们可以看到大量的用```''```和```""```囊括的字符串。在上个章节的技能代码实现里，也包含一个关键的字符串：

```JavaScript
            'jxkz_shuohua':{
                enable:'phaseUse',
                content:function(){
                    player.say("你好，无名杀！");
                }
            },
```

如果我们把这段代码里的```你好，无名杀！```修改为其它内容，就可以在游戏中，让角色说出不同的话语。

![字符串示范](1.jpg)

### 数组

如果我们要表示一个或多个数，我们可以使用数组（Array）字面量，例如：

```JavaScript
[1,2,3,4,5,6,7]
[1,1,4,5,1,4]
[1.1,4.51,4.19,19.8,10]
```

虽然名为“数组”，但其内容并不仅限于数字。任何量都可以填入数组中，例如：

```JavaScript
['全体目光向我看齐',"看我看我",'我宣布个事儿',"我是个数组！",666,666]
```

### 对象

对象（Object）是编程语言中的一个概念。在现实中，它的定义为“具体的某一个事物”，在编程语言里，可以理解为“具有某些属性，且可以对其进行某些操作的一个实体”。

我们可以写一个对象字面量：

```JavaScript
{
    name:"坤坤",
    practiseTime:2.5,
    hobbies:["唱","跳","RAP","篮球"],
    skills:["铁山靠"],
    music:"只因你太美.mp3"
}
```

对象字面量可以嵌套对象字面量，就像这样：

```JavaScript
{
    name:"坤坤",
    practiseTime:{
        value:2.5,
        unit:'年',
    },
    hobbies:["唱","跳","RAP","篮球"],
    skills:["铁山靠"],
    music:"只因你太美.mp3"
}
```

在扩展中，我们可以看到大量的对象字面量，用```{}```囊括，且内部包含多个```key:value```键值对形式。每个键值对都以```,```结尾，最后一个键值对前的```,```可以省略。

注意，不是所有```{}```包括的都是对象字面量，请注意其具体形式和上下文。举例：

```JavaScript
function(){

}
//这是函数字面量。
()=>{

}
//这也是函数字面量。
for(var i=0;i<100;i++){
    alert("你好");
}
//这是for循环语句。
"{}"
//这是字符串。
```

```{}```是一对经常使用的符号。后面我们会逐渐熟悉它的作用。

### 函数

函数[^函数]（function），指具有特定作用的代码块，这里只做简单介绍，之后会详细说明。以下是一些函数字面量的范例：

[^函数]: 函数（function）有时也可以称呼为方法（method），后者在面向对象相关会频繁提到，本教程出于习惯，可能会同时使用这两种叫法。

```JavaScript
function(event,player){
    return player.hp <= 4;
}
//普通函数。

(item)=>item.name != param.name;
//箭头函数。

```

在以下技能代码中，```content```后面的部分就是一个函数字面量。

```JavaScript
            'jxkz_baoyuan':{
                trigger:{
                    player:'damageEnd',
                },
                content:function(){
                    player.say('你干嘛哈哈哎呦');
                }
            }
```

## 变量

关于字面量，我们已经有了一个大致的了解，下面介绍一个新概念：变量。

变量，顾名思义，意思为“可变的量”。如果你有初高中数学的基础，你应该明白表达式中未知数```x```的概念。

在JavaScript中，我们用```var```或```let```[^let]关键字[^关键字]来声明变量。关于```var```与```let```的区别，后面会讲述。

范例：

[^let]: 现代JavaScript一般推荐使用```let```这种定义域明确的关键字声明变量。然而由于某些特殊的原因，技能代码中使用```let```关键字会导致兼容版无名杀报错。（无名杀新版本的生成器函数特性解决了这个问题，但是由于无名杀大量技能代码都不是用生成器函数的方式来编写，所以本教程前所有范例都用无名杀传统的技能代码编写方式。生成器方式可等待后续补充。）鉴于兼容版用户极少，本教程后面的范例代码将兼用```var```与```let```。

[^关键字]: 在代码中具有特殊意义的某些单词。任何变量不得使用关键字进行命名。

```JavaScript
var m = 3;
let p = 2;
var str = "你好";
```

在第一章的教学代码里，我们可以把技能代码改写成如下形式：

```JavaScript
            'jxkz_shuohua':{
                enable:'phaseUse',
                content:function(){
                    let str = "你好，无名杀！";
                    player.say(str);
                }
            },
```

先声明了一个叫```str```的变量，为其赋初值为字符串```"你好，无名杀！"```，后面再使用这个变量。

变量的值可以被改变，例如：

```JavaScript
            'jxkz_shuohua':{
                enable:'phaseUse',
                content:function(){
                    let str = "你好，无名杀！";
                    player.say(str);
                    str = "你干嘛哈哈";
                    player.say(str);
                }
            },
```

执行后我们发现，两次```say```访问的```str```显示的实际字符串不一样，这就是因为中途其数值被改变了。


